import{j as e,U as m,a as j,r as i,S as A,N as M,A as z}from"./index-DqpGZtZS.js";import{e as G}from"./index-CWU1N5XH.js";import{B as p}from"./buttons-DpToUdmo.js";import{R as H,S as V,U,V as W,P as F}from"./PieChart-BLZbk7_a.js";const _=({datos:r=[],imprimirCopia:s})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-700 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-[#FFFDF5]",children:e.jsxs("tr",{children:[Object.keys(r[0]).map((n,a)=>e.jsx("th",{scope:"col",className:"px-6 py-3",children:n},a)),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Imprimir"})]})}),e.jsx("tbody",{children:r.map((n,a)=>e.jsxs("tr",{className:"bg-white border-b  border-gray-200 hover:bg-[#FDF5D4]",children:[Object.values(n).map((o,l)=>e.jsx("td",{className:"px-6 py-3 text-gray-700",children:o||"N/A"},l)),e.jsx("td",{className:"py-3 text-center",children:e.jsx("button",{className:"font-medium text-gray-800 hover:underline text-center",onClick:()=>s(n),children:e.jsx("span",{className:"text-center",children:e.jsx(G,{className:"text-xl"})})})})]},a))})]})})}),K=async(r,s={},n)=>{try{n(!0);const a=await fetch(`${m}boletas/historial?movimiento=${s==null?void 0:s.movimiento}&producto=${s==null?void 0:s.producto}&dateIn=${s==null?void 0:s.dateIn}&dateOut=${s==null?void 0:s.dateOut}&socios=${s==null?void 0:s.socio}`,{method:"GET",headers:{Authorization:j.get("token")}});if(!a.ok)throw new Error("Error en la respuesta de la API");const o=await a.json();r(o)}catch(a){console.error("Error al obtener los clientes:",a)}finally{n(!1)}},S=async r=>{try{const s=await fetch(`${m}boletas/informes`,{method:"GET",headers:{Authorization:j.get("token")}});if(!s.ok)throw new Error("Error en la respuesta de la API");const n=await s.json();r(n)}catch(s){console.error("Error al obtener los clientes:",s)}},X=({handleChange:r,dataSelect:s,handlePushFilter:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha inicial"}),e.jsx("input",{name:"dateIn",onChange:r,className:"w-full px-3 py-2 text-sm font-medium text-gray-600  rounded-lg border border-gray-200 max-sm:hidden",type:"date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Final"}),e.jsx("input",{name:"dateOut",onChange:r,className:"w-full px-3 py-2 text-sm font-medium text-gray-600  rounded-lg border border-gray-200 max-sm:hidden",type:"date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Socio"}),e.jsxs("select",{name:"socio",onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:0,children:[e.jsx("option",{disabled:!0,value:0,children:" Ingrese un socio "}),s!={}&&s&&(s==null?void 0:s.socios.map(({socio:a})=>e.jsx("option",{value:a,children:a},a)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Productos"}),e.jsxs("select",{name:"producto",onChange:r,defaultValue:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{disabled:!0,value:0,children:"Ingrese un producto"}),s!={}&&s&&(s==null?void 0:s.producto.map(({id:a,nombre:o})=>e.jsx("option",{value:o,children:o},a)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Movimiento"}),e.jsxs("select",{name:"movimiento",onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:0,children:[e.jsx("option",{disabled:!0,value:0,children:"Ingrese un movimiento"}),s!={}&&s&&(s==null?void 0:s.movimiento.map(({id:a,nombre:o})=>e.jsx("option",{value:o,children:o},a)))]})]}),e.jsx("div",{className:"flex items-center justify-end col-span-3",children:e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 mr-2 text-sm font-medium",children:"Limpiar Filtros"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Aplicar Filtros"})]})})]}),e.jsx("hr",{className:"mt-10 mb-4 text-gray-400"})]}),d={primary:"#3B82F6",success:"#10B981",warning:"#F59E0B",danger:"#EF4444",info:"#6366F1",cardBackground:"#FFFFFF",border:"#E5E7EB"},g=[d.primary,d.success,d.danger,d.warning,d.info],q=({children:r})=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"p-5",children:r})}),b=({data:r,title:s,subtitle:n})=>{const a=r.map(o=>({tipo:Object.keys(o)[0],value:Object.values(o)[0]}));return e.jsxs(q,{children:[console.log(r),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n})]}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{width:"100%",height:250,children:e.jsxs(V,{children:[e.jsx(U,{data:a,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:2,dataKey:"value",labelLine:!1,label:({name:o,percent:l})=>`${Object.keys(r[o])[0]} (${(l*100).toFixed(0)}%)`,children:a.map((o,l)=>e.jsx(W,{fill:g[l%g.length],stroke:"#FFFFFF",strokeWidth:2},`cell-${l}`))}),e.jsx(F,{contentStyle:{backgroundColor:d.cardBackground,borderColor:d.border,borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},formatter:(o,l,t)=>[`${o} pesajes`,t.payload.tipo]})]})})}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Actualizado: ",new Date().toLocaleString()]})]})},ee=()=>{const[r,s]=i.useState(),[n,a]=i.useState(!1),[o,l]=i.useState({}),[t,y]=i.useState({movimiento:"",producto:"",socio:""}),[x,v]=i.useState(!1),[N,u]=i.useState(!1),[f,h]=i.useState(),w=c=>{const{name:R,value:L}=c.target;y(T=>({...T,[R]:L})),console.log(t)};i.useEffect(()=>{S(l)},[]);const E=c=>{console.log(c)},k=()=>{if(console.log(t),!(t!=null&&t.dateIn)||!(t!=null&&t.dateOut)){u(!0),h("Ingrese la fecha inicial y fecha final, para poder realizar el filtrado o exportaciones a: PDF | Excel");return}K(s,t,a)},C=()=>{if(!(t!=null&&t.dateIn)||!(t!=null&&t.dateOut)){u(!0),h("Ingrese la fecha inicial y fecha final, para poder realizar el filtrado o exportaciones a: PDF | Excel");return}const c=`${m}boletas/export/excel?movimiento=${t==null?void 0:t.movimiento}&producto=${t==null?void 0:t.producto}&dateIn=${t==null?void 0:t.dateIn}&dateOut=${t==null?void 0:t.dateOut}&socio=${t==null?void 0:t.socio}`;window.open(c,"_blank")},D=()=>{u(!1)},I={handleChange:w,dataSelect:o,handlePushFilter:k},O={name:f,hdClose:D},$={datos:r==null?void 0:r.table,imprimirCopia:E},P={data:r==null?void 0:r.graphProcesos,title:"Distribución de Procesos",subtitle:"Distribución por porcentaje de entradas, salidas y boletas canceladas"},B={data:r==null?void 0:r.graphEstados,title:"Distribución por Tipo De Boleta",subtitle:"Distribución por porcentaje de boleta especial, comodín y boleta normal"};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h1",{className:"text-3xl font-bold titulo",children:"Reportes de Boletas"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona los informes generados en el sistema."})]})}),e.jsxs("div",{className:"bg-white shadow-lg rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"w-full p-3 pl-10 text-sm bg-white border  rounded-lg",type:"text",placeholder:"Buscar boletas por ID, placas o motorista..."}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),e.jsx(p,{name:"Exportar PDF",className:"w-full justify-center"}),e.jsx(p,{name:"Exportar EXCEL",fun:C,className:"w-full justify-center"})]})}),e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Filtros de Reporte"}),e.jsxs("button",{onClick:()=>v(!x),className:"flex items-center px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:x?"Ocultar filtros":"Mostrar filtros"}),e.jsx("svg",{className:`w-5 h-5 ml-2 transition-transform duration-200 ${x?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),x&&e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:e.jsx(X,{...I})})]}),e.jsx("div",{className:"p-6",children:n&&!r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(A,{})}):!r||r.table.length===0?e.jsx("div",{className:"py-12",children:e.jsx(M,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-100",children:e.jsx(b,{...P})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-100",children:e.jsx(b,{...B})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Historial de Boletas"}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:e.jsx(_,{...$})})]})]})})]}),N&&e.jsx(z,{...O})]})};export{ee as default};
